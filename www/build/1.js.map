{"version":3,"sources":["../../src/pages/list-a/list-a.module.ts","../../src/app/lazy.load.ts","../../src/directives/directives.module.ts","../../src/directives/lazy-src/lazy-src.ts","../../src/pages/list-a/list-a.ts"],"names":[],"mappings":"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","file":"1.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ListAPage } from './list-a';\nimport {DirectivesModule} from \"../../directives/directives.module\";\n\n@NgModule({\n  declarations: [\n    ListAPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ListAPage),DirectivesModule\n  ],\n})\nexport class ListAPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/list-a/list-a.module.ts","import {Content} from \"ionic-angular\";\r\n\r\nexport class LazyLoad {\r\n    private static instance:LazyLoad=new LazyLoad();\r\n\r\n    constructor(){\r\n        if (LazyLoad.instance) {\r\n            throw new Error(\"错误: 请使用AppGlobal.getInstance() 代替使用new.\");\r\n        }\r\n        LazyLoad.instance = this;\r\n    }\r\n\r\n    public static getInstance(): LazyLoad {\r\n        return LazyLoad.instance;\r\n    }\r\n\r\n    scrollEnd(content: Content) {\r\n        setTimeout(() => {\r\n            let el = content._elementRef.nativeElement;\r\n            let imgs = el.querySelectorAll(\"[src-lazy]\");\r\n            this.loadImg(content, imgs);\r\n        }, 200);\r\n    }\r\n\r\n    private loadImg(content, imgs) {\r\n        for (let i = 0; i < imgs.length; i++) {\r\n            let img = imgs[i];\r\n            let lazySrc = img.getAttribute(\"src-lazy\");\r\n            let offsetTop = LazyLoad._calcOffsetTop(img);\r\n            if (offsetTop >= content.scrollTop && offsetTop <= content.scrollTop + content.contentHeight && lazySrc && !img.getAttribute(\"lazy-loaded\")) {\r\n                img.setAttribute(\"lazy-loaded\",\"1\")\r\n                if(img.nodeName==\"IMG\"){\r\n                    img.src = lazySrc;\r\n                    img.onload = () => {\r\n                        this.loadImg(content, imgs);\r\n                    };\r\n                    img.onerror = () => {\r\n                        this.loadImg(content, imgs);\r\n                    };\r\n                } else {\r\n                    img.style.backgroundImage=\"url('\"+lazySrc+\"')\";\r\n                    this.loadImg(content, imgs);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    static _calcOffsetTop(img, top = 0): number {\r\n        top = top + img.offsetTop;\r\n        if (img.offsetParent) {\r\n            if (img.offsetParent.className == \"scroll-content\") {\r\n                return top;\r\n            }\r\n            return LazyLoad._calcOffsetTop(img.offsetParent, top);\r\n        }\r\n        return top;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/lazy.load.ts","import { NgModule } from '@angular/core';\nimport {LazySrcDirective} from \"./lazy-src/lazy-src\";\n@NgModule({\n\tdeclarations: [LazySrcDirective],\n\timports: [],\n\texports: [LazySrcDirective]\n})\nexport class DirectivesModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/directives/directives.module.ts","import {Directive, ElementRef, Input} from '@angular/core';\r\nimport {Content} from \"ionic-angular\";\r\nimport {LazyLoad} from \"../../app/lazy.load\";\r\n\r\n/**\r\n * Generated class for the SrcLazyDirective directive.\r\n *\r\n * See https://angular.io/api/core/Directive for more info on Angular\r\n * Directives.\r\n */\r\n@Directive({\r\n    selector: '[lazy-src]' // Attribute selector\r\n})\r\nexport class LazySrcDirective {\r\n    @Input(\"lazy-src\") src: string;\r\n    @Input(\"lazy-content\") content: Content;\r\n\r\n    constructor(private elementRef: ElementRef) {\r\n    }\r\n\r\n    ngOnInit() {\r\n        let img = this.elementRef.nativeElement;\r\n        img.setAttribute(\"src-lazy\", this.src);\r\n        img.setAttribute(\"src\", \"data:image/gif;base64,R0lGODlhAQABAJEAAAAAAP///+fn5////yH5BAEAAAMALAAAAAABAAEAAAICVAEAOw==\");\r\n        let content = this.content;\r\n        setTimeout(()=>{\r\n            let offsetTop = LazyLoad._calcOffsetTop(img);\r\n            if (offsetTop >= content.scrollTop && offsetTop <= content.scrollTop + content.contentHeight && this.src && !img.getAttribute(\"lazy-loaded\")) {\r\n                img.setAttribute(\"lazy-loaded\", \"1\");\r\n                if (img.nodeName == \"IMG\") {\r\n                    img.src = this.src;\r\n                } else {\r\n                    img.style.backgroundImage = \"url('\" + this.src + \"')\";\r\n                }\r\n            }\r\n        },100);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/directives/lazy-src/lazy-src.ts","import { Component } from '@angular/core';\nimport {Content, IonicPage, NavController, NavParams} from 'ionic-angular';\nimport {HttpClient} from \"@angular/common/http\";\nimport {LazyLoad} from \"../../app/lazy.load\";\n\n/**\n * Generated class for the ListAPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-list-a',\n  templateUrl: 'list-a.html',\n})\nexport class ListAPage {\n\n  items=[];\n\n  constructor(public navCtrl: NavController, public navParams: NavParams,private httpClint:HttpClient) {\n  }\n\n  ionViewDidLoad() {\n    this.loadList();\n  }\n\n  loadList(e?){\n    this.httpClint.get(\"https://randomuser.me/api/?results=20\").subscribe(data=>{\n      console.log(data);\n      this.items=this.items.concat(data[\"results\"]);\n      e&&e.complete();\n    });\n  }\n\n  refresh(e){\n    this.items=[];\n    this.loadList(e);\n  }\n  loadMore(e){\n    this.loadList(e);\n  }\n\n  scrollEnd(content: Content) {\n    LazyLoad.getInstance().scrollEnd(content);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/list-a/list-a.ts"],"sourceRoot":""}